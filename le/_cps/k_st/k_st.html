<!DOCTYPE html>
<html>
 <head>
  <meta charset="UTF-8">
  <meta name="keywords" content="駒場東邦物理部,駒場東邦,駒東,KTPC,物理部,プログラミング,C++,講習">
  <meta name="description" content="駒場東邦物理部(KTPC)部員向けC++講習の資料です。構造体の解説をしています。">
  <meta name="author" content="駒場東邦物理部">
  <meta http-equiv="content-language" content="ja">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>構造体 - C++講習 - 駒場東邦物理部</title>
  <link rel="icon" type="image/jpeg" href="../../../images/logo.jpg">
  <link rel="stylesheet" type="text/css" href="../../../style.css">
  <link rel="stylesheet" type="text/css" media="(max-width:800px)" href="../../../static.css">
  <script type="text/javascript" src="../../../header.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133906591-2"></script>
  <script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());
   
   gtag('config', 'UA-133906591-2');
  </script>
 </head>
 <body>
  <header class="ch00">
   <img class="ch11" src="../../../images/br.jpg">
  </header>
  <div class="chb">
   <div class="ch01">
    <div class="ch10">
     <div class="ch21">
      <button type="button" class="ch31" onclick="ck()">
       <img class="ch42" src="../../../images/menu.png">
      </button>
     </div>
     <div id="hnmu" class="ch22" style="display: none; pointer-events:none;">
      <div class="ch32">
       <span class="ch40">
        <span class="ch50">駒場東邦物理部</span>
       </span>
       <a class="ch41" href="../../../index.html">
        <span class="ch50">トップページ</span>
       </a>
       <a class="ch41" href="../../le.html">
        <span class="ch50">講習トップ</span>
       </a>
      </div>
      <div class="ch32">
       <span class="ch40">
        <span class="ch50">C++講習</span>
       </span>
       <a class="ch41" href="../_cps.html">
        <span class="ch50">目次</span>
       </a>
       <a class="ch41" href="../i_dx/i_dx.html">
        <span class="ch50">索引</span>
       </a>
       <a class="ch41" href="../k_t_fcba/k_t_fcba.html">
        <span class="ch50">前回</span>
       </a>
       <a class="ch41" href="../ifadsh/ifadsh.html">
        <span class="ch50">次回</span>
       </a>
      </div>
     </div>
    </div>
   </div>
   <div class="cb00">
    <div class="cb10">
     <article class="cb20">
      <h1>C++講習/構造体</h1>
     </article>
     <article class="cb21 fxtb">
      <h2 class="cb33">概要</h2>
      <span class="cb34">
       構造体、特にPODと呼ばれるC言語互換形式のものについて解説します。
      </span>
     </article>
     <article class="cb21 fxlr">
      <div class="cb36 debr">
       <h4 class="cb44">
        重要語
       </h4>
       <h4 class="cb45">
        構造体
       </h4>
       <span class="cb41">
        複数の変数などをまとめた型を作るもの
       </span>
       <h4 class="cb45">
        メンバ
       </h4>
       <span class="cb41">
        構造体の中にある変数などのこと
       </span>
       <h4 class="cb45">
        構造体の宣言
       </h4>
       <span class="cb41">
        構造体の名前を定義すること
       </span>
       <h4 class="cb45">
        構造体の定義
       </h4>
       <span class="cb41">
        構造体の名前とメンバを定義すること
       </span>
       <h4 class="cb45">
        構造体変数の宣言
       </h4>
       <span class="cb41">
        定義した構造体の変数を宣言すること
       </span>
       <h4 class="cb45">
        ドット演算子
       </h4>
       <span class="cb41">
        構造体のメンバにアクセスする演算子
       </span>
       <h4 class="cb45">
        アロー演算子
       </h4>
       <span class="cb41">
        <code>(*).</code>の糖衣構文
       </span>
       <h4 class="cb45">
        エイリアス
       </h4>
       <span class="cb41">
        英語で「別名、通称」などの意味の単語。
       </span>
       <h4 class="cb45">
        エイリアス宣言
       </h4>
       <span class="cb41">
        型名の別名を宣言する言語機能
       </span>
       <h4 class="cb45">
        typedef
       </h4>
       <span class="cb41">
        型の別名を宣言するキーワード
       </span>
      </div>
      <div class="cb36 debr">
       <h4 class="cb44">
        必要語
       </h4>
       <h4 class="cb45">
        変数の宣言
       </h4>
       <span class="cb41">
        変数の型と名前を定義すること
       </span>
       <h4 class="cb45">
        ポインタ変数
       </h4>
       <span class="cb41">
        アドレスを値として持つ変数
       </span>
       <h4 class="cb45">
        ポインタ型
       </h4>
       <span class="cb41">
        ポインタ変数の型
       </span>
       <h4 class="cb45">
        間接参照
       </h4>
       <span class="cb41">
        アドレスを変数のように扱うこと
       </span>
       <h4 class="cb45">
        糖衣構文/シンタックスシュガー
       </h4>
       <span class="cb41">
        長い、又は複雑な構文の簡単な書き方
       </span>
      </div>
     </article>

      <article class="cb21 fxtb">
       <h2 class="cb33">構造体基本</h2>
       <span class="cb34">
        構造体の宣言/定義/初期化/メンバアクセスについてです。<br>
        次のサンプルコードを実行してみましょう。
       </span>
      </article>
      <article class="cb21 fxrl">
       <div class="cb37">
        <div class="cb46">
         <span class="cb54">構造体基本</span>
         <button type="button" class="cb53" onclick="copy('saco_1')">
          <span class="cb61">COPY</span>
         </button>
        </div>
        <code class="cb47">
<pre id="saco_1" class="cb55 bkgdbl">
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>Windows.h<span class="wdsl">&gt;</span>
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>string<span class="wdsl">&gt;</span>

<span class="wdkywd">struct</span> item<span class="wdsl">;</span>

<span class="wdkywd">struct</span> item <span class="wdsl">{</span>
    <span class="wdkywd">int</span> number<span class="wdsl">;</span>
    std<span class="wdsl">::</span>wstring name<span class="wdsl">;</span>
<span class="wdsl">};</span>

<span class="wdkywd">void</span> show_item<span class="wdsl">(</span>item a<span class="wdsl">)</span> <span class="wdsl">{</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        a.name.c_str<span class="wdsl">(),</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>a.number<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        MB_OK
    <span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">void</span> show_item_p<span class="wdsl">(</span>item<span class="wdsl">*</span> a<span class="wdsl">)</span> <span class="wdsl">{</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        a<span class="wdsl">-&gt;</span>name.c_str<span class="wdsl">(),</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>a<span class="wdsl">-&gt;</span>number<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        MB_OK
    <span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">int</span> wWinMain<span class="wdsl">(</span>HINSTANCE<span class="wdsl">,</span> HINSTANCE<span class="wdsl">,</span> LPWSTR<span class="wdsl">,</span> <span class="wdkywd">int</span><span class="wdsl">)</span> <span class="wdsl">{</span>
    item a<span class="wdsl">;</span>
    a.number <span class="wdsl">=</span> <span class="wdnr">1</span><span class="wdsl">;</span>
    a.name <span class="wdsl">=</span> <span class="wdtt">L"Shibuya"</span><span class="wdsl">;</span>

    item b<span class="wdsl">{</span> <span class="wdnr">3</span><span class="wdsl">,</span><span class="wdtt">L"Komabatodaimae"</span> <span class="wdsl">};</span>

    show_item<span class="wdsl">(</span>a<span class="wdsl">);</span>
    show_item_p<span class="wdsl">(&amp;</span>b<span class="wdsl">);</span>

    <span class="wdkywd">return</span> <span class="wdnr">0</span><span class="wdsl">;</span>
<span class="wdsl">}</span>
</pre>
        </code>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">構造体の宣言</h3>
        <span class="cb41">
         構造体は、関数と同様に宣言と定義を区別します。<br>
         宣言は<code>struct</code>というキーワードを使い、<code>struct 構造体名;</code>という構文を用います。<br>
         後述する、構造体の定義の前におかれている宣言を、前方宣言と呼びます。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">構造体の定義</h3>
        <span class="cb41">
         関数と同様に、構造体の宣言に波括弧を付けると定義となります。<br>
         構造体の定義は<code>struct 構造体名 { メンバ並び };</code>という構文を用います。<br>
         構造体は複数の変数をまとめる機能が主なので、メンバ並びに変数宣言を記述していきます。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">構造体変数の宣言/初期化</h3>
        <span class="cb41">
         宣言した構造体を使うには、組み込み型と同様の形で変数の宣言を行います。<br>
         宣言した構造体を型として、宣言された変数を構造体変数と呼ぶことがあります。<br>
         初期化は波括弧を使い、<code>メンバ並び</code>の記述順にコンマ区切りで値を渡して行います。
        </span>
       </div>
      </article>
      <article class="cb21 fxtb">
       <h2 class="cb33">メンバアクセス</h2>
       <span class="cb34">
        構造体のわかりにくいところ、構造体が持つメンバへのアクセス方法についてです。<br>
       </span>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">メンバアクセス - ドット演算子</h3>
        <span class="cb41">
         当然ですが、構造体変数が持っている変数にアクセスすることが出来ます。<br>
         構造体のメンバにアクセスする際には、<code>変数名.メンバ名</code>という構文を使用します。<br>
         なお、<code>変数名.メンバ名</code>は1つの変数を指すので、まとめて1つの変数の名前と見なせます。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">メンバアクセス - ポインタ変数から</h3>
        <span class="cb41">
         組み込み型にポインタ変数があるように、構造体にもポインタ変数が存在します。<br>
         もちろんポインタ型は<code>構造体名*</code>で、ポインタ変数の宣言やアドレス演算子は変わりません。<br>
         ただし、ポインタ変数からのメンバアクセスは<code>(*変数名).メンバ名</code>となります。<br>
         これは、ドット演算子の方が間接参照演算子よりも優先されてしまうからです。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">メンバアクセス - アロー演算子</h3>
        <span class="cb41">
         先述したように、ポインタ変数からメンバアクセスする際は<code>(*変数名).メンバ名</code>となります。<br>
         しかし演算子を2つ使い、丸括弧も付けないといけないのは間違いの元です。<br>
         そのため、アロー演算子というシンタックスシュガーが存在します。<br>
         アロー演算子を用いると、<code>変数名->メンバ名</code>と記述することが出来ます。
        </span>
       </div>
      </article>
      <article class="cb21 fxtb">
       <h2 class="cb33">コード「構造体基本」解説</h2>
       <span class="cb34">
        コード「構造体基本」の解説です。
       </span>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>item</code>構造体の定義</h3>
        <span class="cb41">
         構造体の定義には<code>struct 構造体名 { メンバ並び };</code>の構文を使います。<br>
         <code>int</code>と<code>std::wstring</code>をもつ構造体<code>item</code>を宣言しています。<br>
         そして、それぞれ<code>number</code>と<code>name</code>という名前を付けています。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>item</code>構造体変数の宣言と初期化</h3>
        <span class="cb41">
         構造体も組み込みと同じ変数宣言の形を用いりました。<br>
         ただし、初期化は波括弧を用いて、<code>リスト並び</code>で行うのでした。<br>
         <code>wWinMain</code>関数内では、<code>item</code>構造体の変数<code>a</code>と<code>b</code>を宣言しています。<br>
         <code>a</code>はドット演算子でメンバアクセスして値を与えています。<br>
         対して<code>b</code>は、波括弧の初期化をしています。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>show_item、show_item_p</code>関数</h3>
        <span class="cb41">
         <code>show_item</code>関数は<code>item</code>構造体を値渡しで受け取ります。<br>
         対して、<code>show_item_p</code>関数は<code>item</code>構造体へのポインタを受け取っています。<br>
         処理はどちらも<code>item</code>構造体の内容をメッセージボックスに出力しています。<br>
         メンバアクセスは<code>show_item</code>関数では、ドット演算子を使います。<br>
         対して<code>show_item_p</code>関数はポインタなので、アロー演算子を使っています。
        </span>
       </div>
      </article>
      <article class="cb21 fxtb">
       <h2 class="cb33">エイリアス</h2>
       <span class="cb34">
        型名の別名、エイリアスについてです。以下のサンプルコードを実行してみましょう。
       </span>
      </article>
      <article class="cb21 fxrl">
       <div class="cb37">
        <div class="cb46">
         <span class="cb54">エイリアス</span>
         <button type="button" class="cb53" onclick="copy('saco_2')">
          <span class="cb61">COPY</span>
         </button>
        </div>
        <code class="cb47">
<pre id="saco_2" class="cb55 bkgdbl">
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>Windows.h<span class="wdsl">&gt;</span>
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>string<span class="wdsl">&gt;</span>

<span class="wdkywd">struct</span> tagITEM<span class="wdsl">;</span>

<span class="wdkywd">using</span> show_func <span class="wdsl">=</span> <span class="wdkywd">void</span><span class="wdsl">(</span>tagITEM<span class="wdsl">*);</span>
<span class="wdkywd">using</span> show_func_ptr <span class="wdsl">=</span> show_func<span class="wdsl">*;</span>

<span class="wdkywd">typedef</span> <span class="wdkywd">struct</span> tagITEM <span class="wdsl">{</span>
    <span class="wdkywd">int</span> number<span class="wdsl">;</span>
    std<span class="wdsl">::</span>wstring name<span class="wdsl">;</span>
    show_func_ptr show<span class="wdsl">;</span>
<span class="wdsl">}</span> ITEM<span class="wdsl">,</span> <span class="wdsl">*</span> LPITEM<span class="wdsl">;</span>

<span class="wdkywd">void</span> show_item<span class="wdsl">(</span>LPITEM item<span class="wdsl">)</span> <span class="wdsl">{</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        item<span class="wdsl">-&gt;</span>name.c_str<span class="wdsl">(),</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>item<span class="wdsl">-&gt;</span>number<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        MB_OK
    <span class="wdsl">);</span>
<span class="wdsl">}</span>

<span class="wdkywd">int</span> wWinMain<span class="wdsl">(</span>HINSTANCE<span class="wdsl">,</span> HINSTANCE<span class="wdsl">,</span> LPWSTR<span class="wdsl">,</span> <span class="wdkywd">int</span><span class="wdsl">)</span> <span class="wdsl">{</span>
    ITEM a<span class="wdsl">{</span> <span class="wdnr">1</span><span class="wdsl">,</span><span class="wdtt">L"hanauta"</span><span class="wdsl">,</span>show_item <span class="wdsl">};</span>

    a.show<span class="wdsl">(&amp;</span>a<span class="wdsl">);</span>

    <span class="wdkywd">return</span> <span class="wdnr">0</span><span class="wdsl">;</span>
<span class="wdsl">}</span>
</pre>
        </code>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">エイリアス宣言</h3>
        <span class="cb41">
         エイリアス宣言は、型名の別名を定義する言語機能です。<br>
         <code>using 別名 = 型名;</code>という構文で、<code>型名</code>の<code>別名</code>を定義します。<br>
         この<code>型名</code>にはポインタ型なども指定でき、1つの型として宣言できます。<br>
         また、<code>別名</code>はエイリアス宣言後にあらゆる場所で通常の型と同様に使用できます。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">補足 - 変数宣言</h3>
        <span class="cb41">
         実は、変数宣言の<code>型名 変数名</code>には、コンマ区切りで<code>変数名</code>を追加できます。<br>
         ここで問題になるのが、ポインタ変数宣言でのアスタリスクは<code>変数名</code>に係ることです。<br>
         そのため、コンマ区切りの各変数名にアスタリスクを付けないとポインタ変数になりません。<br>
         すなわち<code>型名* 変数名A,変数名B;</code>とすると、<code>変数名A</code>は<code>型名*</code>ですが、<code>変数名B</code>は<code>型名</code>です。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>typedef</code></h3>
        <span class="cb41">
         <code>typedef</code>は、<code>typedef 変数宣言</code>という形で変数の別名を定義するためのキーワードです。<br>
         すなわち<code>変数宣言</code>の<code>変数名</code>が、別名として宣言、定義されることになります。<br>
         サンプルコードでは構造体の宣言と同時に構造体変数を宣言する形で別名を宣言しています。<br>
         実は、構造体の宣言時の波括弧の後に<code>変数名</code>を変数宣言の<code>変数名</code>以下同様に記述できます。<br>
         なお、<code>typedef</code>は旧来の方法なのでC++ではエイリアス宣言を使うことが推奨されています。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">コラム - <code>LPWSTR</code>の正体</h3>
        <span class="cb41">
         <code>wWinMain</code>関数の引数に、<code>LPWSTR</code>がありました。<br>
         これは、<code>LP</code>がポインタ、<code>W</code>がワイド文字、<code>STR</code>が文字列を意味します。<br>
         ワイド文字というのは、Visual StudioにおいてはUTF-16LEの文字のことです。<br>
         つまり、UTF-16LEを扱える型の文字列へのポインタということになります。<br>
         厳密に言うと、UTF-16LEを扱える型の文字へのポインタです。<br>
         配列を学ぶとここで言っていることがわかるようになるでしょう。<br>
         実際には、<code>LPWSTR</code>が<code>typedef WCHAR *LPWSTR;</code>で、<code>WCHAR</code>が<code>typedef wchar_t WCHAR;</code>です。
        </span>
       </div>
      </article>
      <article class="cb21 fxtb">
       <h2 class="cb33">コード「エイリアス」解説</h2>
       <span class="cb34">
        コード「エイリアス」の解説です。
       </span>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>show_func、show_func_ptr</code></h3>
        <span class="cb41">
         双方とも、エイリアス宣言によって宣言されている、型の別名です。<br>
         ただ、構造体<code>tagITEM</code>の構造体名を使いたいので、前方宣言をしています。
         <code>show_func</code>は、返り値<code>void</code>、引数は構造体<code>tagITEM</code>へのポインタを取る関数の型です。<br>
         <code>show_func_ptr</code>は<code>show_func</code>へのポインタ、即ち<code>void(*)(tagITEM*)</code>を表わします。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">構造体<code>tagITEM</code>の定義</h3>
        <span class="cb41">
         構造体<code>tagITEM</code>は、typedefと組み合わせています。<br>
         そして、<code>tagITEM</code>の別名<code>ITEM</code>と、<code>tagITEM</code>へのポインタ型<code>LPITEM</code>を定義しています。<br>
         <code>tagITEM</code>の<code>tag</code>というのはC言語では構造体名は型名でなく、タグ名だったことに由来します。<br>
         <code>LPITEM</code>の<code>LP</code>は、Windows APIがポインタ型の接頭辞で<code>LP</code>を使っていることに由来します。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40">補足 - C言語での構造体</h3>
        <span class="cb41">
         実は、C言語だと構造体名はタグ名であって、単体では型名にならなかったのです。<br>
         そのため、構造体変数を宣言するとき、<code>struct 構造体名 変数名;</code>と言う構文でした。<br>
         ただし互換性から、C++でもこの構造体変数の構文を用いても良いことになっています。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>show_item</code>関数</h3>
        <span class="cb41">
         <code>show_item</code>関数は、構造体<code>ITEM</code>のメンバ<code>show</code>に渡すために用意した関数です。<br>
         <code>LPITEM</code>、すなわち<code>ITEM</code>へのポインタを引数に取ります。<br>
         処理は構造体<code>ITEM</code>の内容をメッセージボックスに表示させています。
        </span>
       </div>
      </article>
      <article class="cb21">
       <div class="cb31">
        <h3 class="cb40"><code>a.show(&a)</code></h3>
        <span class="cb41">
         これは、構造体変数<code>a</code>のメンバの<code>show</code>を経由して<code>show_item</code>関数を呼び出しています。<br>
         <code>show_item</code>関数は、<code>LPITEM</code>を引数に取るので、構造体変数<code>a</code>のアドレスを渡しています。
        </span>
       </div>
      </article>
     <article class="cb21 fxtb">
      <h2 class="cb33">練習問題</h2>
      <span class="cb34">
       以下のコードの<code>wWinMain</code>関数を変更せず、書き加える形でプログラムとして完成させてください。<br>
       難しいので、ヒントを複数用意しています。始めに行き詰る時には、ヒントを見てしまいましょう。
      </span>
     </article>
     <article class="cb21 fxrl">
      <div class="cb37">
       <div class="cb46">
        <span class="cb54">解答の一部</span>
        <button type="button" class="cb53" onclick="copy('saco_4')">
         <span class="cb61">COPY</span>
        </button>
       </div>
       <code class="cb47">
<pre id="saco_4" class="cb55 bkgdbl">
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>Windows.h<span class="wdsl">&gt;</span>
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>string<span class="wdsl">&gt;</span>

<span class="wdkywd">void</span> ass<span class="wdsl">(</span><span class="wdkywd">int</span> a<span class="wdsl">,</span> LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    p<span class="wdsl">-&gt;</span>a <span class="wdsl">=</span> a<span class="wdsl">;</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">void</span> show<span class="wdsl">(</span>LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>p<span class="wdsl">-&gt;</span>a<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        <span class="wdtt">L"after"</span><span class="wdsl">,</span>
        MB_OK
    <span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">void</span> call_struct_func<span class="wdsl">(</span><span class="wdkywd">int</span> a<span class="wdsl">,</span> LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    p<span class="wdsl">-&gt;</span>ass<span class="wdsl">(</span>a<span class="wdsl">,</span> p<span class="wdsl">);</span>
    p<span class="wdsl">-&gt;</span>show<span class="wdsl">(</span>p<span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">int</span> wWinMain<span class="wdsl">(</span>HINSTANCE<span class="wdsl">,</span> HINSTANCE<span class="wdsl">,</span> LPWSTR<span class="wdsl">,</span> <span class="wdkywd">int</span><span class="wdsl">)</span> <span class="wdsl">{</span>
    FUNC object<span class="wdsl">{</span> <span class="wdnr">0</span><span class="wdsl">,</span>ass<span class="wdsl">,</span>show <span class="wdsl">};</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>object.a<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        <span class="wdtt">L"before"</span><span class="wdsl">,</span>
        MB_OK
    <span class="wdsl">);</span>

    call_struct_func<span class="wdsl">(</span><span class="wdnr">10</span><span class="wdsl">,</span> <span class="wdsl">&amp;</span>object<span class="wdsl">);</span>
    <span class="wdkywd">return</span> <span class="wdnr">0</span><span class="wdsl">;</span>
<span class="wdsl">}</span>
</pre>
       </code>
      </div>
     </article>
     <article class="cb21 fxlr">
      <details class="cb37">
       <summary class="cb48">ヒント1</summary>
        <code>wWinMain</code>関数内の<code>FUNC</code>は構造体の名前です。<br>
        また、<code>ass</code>関数の引数の<code>LPFUNC</code>は<code>FUNC</code>へのポインタです。
      </details>
     </article>
     <article class="cb21 fxlr">
      <details class="cb37">
       <summary class="cb48">ヒント2</summary>
        ヒント1より、構造体の定義とエイリアスの宣言が必要があります。<br>
        その構造体のメンバの型は初期化から推察が出来ます。
      </details>
     </article>
     <article class="cb21 fxlr">
      <details class="cb37">
       <summary class="cb48">ヒント3</summary>
       構造体のメンバの型は上から、<code>0</code>より<code>int</code>、<br>
       <code>ass</code>関数より<code>void(*)(int,LPFUNC)</code>、<br>
       <code>show</code>関数より<code>void(*)(int,LPFUNC)</code>です。<br>
       また、構造体のメンバの名前は<code>ass</code>関数と<code>call_struct_func</code>関数からわかります。
      </details>
     </article>
     <article class="cb21 fxlr">
      <details class="cb37">
       <summary class="cb48">ヒント4</summary>
       構造体のメンバ名は、それぞれ<code>int</code>は<code>a</code>、<br>
       <code>void(*)(int,LPFUNC)</code>の片方は<code>ass</code>、もう片方は<code>show</code>です。
      </details>
     </article>
     <article class="cb21 fxlr">
      <details class="cb37">
       <summary class="cb48">解答</summary>
       <div class="cb46">
        <span class="cb54">練習問題解答</span>
        <button type="button" class="cb53" onclick="copy('ar_1')">
         <span class="cb61">COPY</span>
        </button>
       </div>
       <code class="cb47">
<pre id="ar_1" class="cb55 bkgdbl">
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>Windows.h<span class="wdsl">&gt;</span>
<span class="wdp_q_p_csc_md">#include</span> <span class="wdsl">&lt;</span>string<span class="wdsl">&gt;</span>

<span class="wdkywd">typedef</span> <span class="wdkywd">struct</span> tagFUNC <span class="wdsl">{</span>
    <span class="wdkywd">int</span> a<span class="wdsl">;</span>
    <span class="wdkywd">void</span><span class="wdsl">(*</span>ass<span class="wdsl">)(</span><span class="wdkywd">int</span><span class="wdsl">,</span> tagFUNC<span class="wdsl">*);</span>
    <span class="wdkywd">void</span><span class="wdsl">(*</span>show<span class="wdsl">)(</span>tagFUNC<span class="wdsl">*);</span>
<span class="wdsl">}</span>FUNC<span class="wdsl">,</span> <span class="wdsl">*</span> LPFUNC<span class="wdsl">;</span>

<span class="wdkywd">void</span> ass<span class="wdsl">(</span><span class="wdkywd">int</span> a<span class="wdsl">,</span> LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    p<span class="wdsl">-&gt;</span>a <span class="wdsl">=</span> a<span class="wdsl">;</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">void</span> show<span class="wdsl">(</span>LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>p<span class="wdsl">-&gt;</span>a<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        <span class="wdtt">L"after"</span><span class="wdsl">,</span>
        MB_OK
    <span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">void</span> call_struct_func<span class="wdsl">(</span><span class="wdkywd">int</span> a<span class="wdsl">,</span> LPFUNC p<span class="wdsl">)</span> <span class="wdsl">{</span>
    p<span class="wdsl">-&gt;</span>ass<span class="wdsl">(</span>a<span class="wdsl">,</span> p<span class="wdsl">);</span>
    p<span class="wdsl">-&gt;</span>show<span class="wdsl">(</span>p<span class="wdsl">);</span>
    <span class="wdkywd">return</span><span class="wdsl">;</span>
<span class="wdsl">}</span>

<span class="wdkywd">int</span> wWinMain<span class="wdsl">(</span>HINSTANCE<span class="wdsl">,</span> HINSTANCE<span class="wdsl">,</span> LPWSTR<span class="wdsl">,</span> <span class="wdkywd">int</span><span class="wdsl">)</span> <span class="wdsl">{</span>
    FUNC object<span class="wdsl">{</span> <span class="wdnr">0</span><span class="wdsl">,</span>ass<span class="wdsl">,</span>show <span class="wdsl">};</span>
    MessageBoxW<span class="wdsl">(</span>
        NULL<span class="wdsl">,</span>
        std<span class="wdsl">::</span>to_wstring<span class="wdsl">(</span>object.a<span class="wdsl">)</span>.c_str<span class="wdsl">(),</span>
        <span class="wdtt">L"before"</span><span class="wdsl">,</span>
        MB_OK
    <span class="wdsl">);</span>

    call_struct_func<span class="wdsl">(</span><span class="wdnr">10</span><span class="wdsl">,</span> <span class="wdsl">&amp;</span>object<span class="wdsl">);</span>
    <span class="wdkywd">return</span> <span class="wdnr">0</span><span class="wdsl">;</span>
<span class="wdsl">}</span>
</pre>
       </code>
      </details>
     </article>
    </div>
   </div>
   <footer class="cf00">
    <div class="cf10">
     <button class="cf21" onclick="tp()">
      <img class="cf30" src="../../../images/top.png">
     </button>
     <span class="cf20">
      (C) 2020 駒場東邦物理部[KTPC]
     </span>
    </div>
   </footer>
  </div>
 </body>
</html>